
\documentclass{amsart}

\usepackage[latin1]{inputenc}
\usepackage{subfigure}
\usepackage{amsfonts, amsmath, thmtools}
\usepackage{fullpage}
\usepackage[pagebackref=false,bookmarksopen=false,colorlinks,citecolor=black,linkcolor=violet]{hyperref} 
\usepackage{multirow,xcolor,pifont,varwidth}

\newcommand{\comment}[1]{\marginpar{\color{red}{\Huge$*$}}\mbox{}{\sf\color{red}[#1]}}

%--------------------------------------
% Theorem definitions
%--------------------------------------
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{cor}[theorem]{Corollary}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{quest}{Question}
\newtheorem*{xtheorem}{Theorem}
\theoremstyle{remark}
\declaretheorem[name=Example,qed={\lower-0.3ex\hbox{$\triangleleft$}}]{example}
\newtheorem{remark}{Remark}


\author{Stephen Melczer, Taras Mychaskiw and Yi Zhang}

\title{Password Authenticated Key Exchange:\\ From Two Party Methods to Group Schemes}

%\keywords{Lattice path enumeration, D-finite, diagonal, analytic
%  combinatorics in several variables, Weyl chambers}


\begin{document}

\begin{abstract}
This project investigates group password authenticated key exchange methods (GPAKEs).  In 
particular, we detail the so-called `fairy ring dance' method recently described by 
Hao et. al.~\cite{HaYiChSh15} which allows for the extension of two party password authenticated key exchange 
methods (PAKEs) with explicit key confirmation to a group setting with an arbitrary number of users without
increasing round complexity (the computational complexity, of course, increases with the number of users).  
This paper presents two new GPAKEs constructed through these means, based on the 
Dragonfly and PAK/PPK two party protocols, and includes timings comparing them to previous GPAKEs of
Hao et. al.~\cite{HaYiChSh15}.
\end{abstract}

%------------------------------------------------------
\maketitle
%------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%
% Introduction
%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}

Since their introduction in the 1990s, password-authenticated key exchange (PAKE) methods -- 
also known as password-authenticated key agreement methods -- have become popular for their 
ability to allow agents sharing a (typically low entropy) password to securely establish shared 
cryptographic keys (see Bellovin and Merritt~\cite{BeMe92} or Jablon~\cite{Ja96} for early examples, 
and Hao and Ryan~\cite{HaRy2010} for a more recent paper).  Although they have been around for decades, 
most research on PAKEs has focused on key establishment between two parities.  For our project, we 
have studied the problem of establishing Group PAKEs (GPAKEs) -- that is, using a low entropy password 
shared between many agents to set up cryptographic keys.  This has modern applications with the rise
of the so-called `Internet of Things', where many consumer devices connected through a local Internet 
connection wish to securely communicate (such schemes would allow, for instance, secure communication 
between a smart television, DVD player, and cable box after their owner inputs a short shared password 
into each upon purchase).
\\

The major issue in designing an efficient GPAKE is to minimize the number of rounds of communication 
between the agents involved, as the latency of such a protocol is determined by the slowest responder 
in each round.  A recent pre-print of Hao et. al.~\cite{HaYiChSh15} proposes a construction which 
allows for the extension of any secure two-party PAKE to a multi-party PAKE with explicit key confirmation
without adding any extra rounds of communication.  The authors continue on to give two explicit schemes 
following from this template: SPEKE+ (using two rounds of communication, adapted from the SPEKE~\cite{Ja96} 
protocol) and J-PAKE+ (using three rounds of communication, adapted from the J-PAKE~\cite{HaRy2010} protocol).
\\ 

The structure of this document is as follows: Section~\ref{sec:PAKE} begins by giving a survey of classical 
two-party PAKEs -- including explicit descriptions of the PAKEs which will be extended into the group 
setting and background information on the zero knowledge proof protocols these use.  Section~\ref{sec:GPAKE} 
starts with a description of the theoretical methodology developed by Hao et. al.~\cite{HaYiChSh15} to extend 
two-party PAKEs into a group setting.  After this theoretical background, we give two explicit GPAKEs 
(SPEKE+ and J-PAKE+) constructed by Hao et. al. using this methodology, followed by two explicit GPAKEs 
which we have derived through the same means (a group variant of the IEEE 802.11-2012 standard Dragonfly 
protocol~\cite{Ha15}, and a variant of the PAK/PPK protocol \cite{BoMaPa00}); the security of these new GPAKEs are proven using 
realistic attack models, when one assumes the underlying two party PAKE protocols are secure.  
In Section~\ref{sec:Implementation} we test the practical efficacy of our new methods 
against the Java implementations of SPEKE+ and J-PAKE+ given by Hao et. al.~\cite{HaYiChSh15}.  Section~\ref{sec:Conclusion} 
concludes with an overview of these results and possible directions for future work.
\\ 

The main original contributions found in this project come from the two new group PAKEs we have constructed 
(see sub-Sections~\ref{sec:Dragon} and~\ref{sec:PPK}), including the proofs of their security and timings 
to compare against SPEKE+ and J-PAKE+.  We have also fleshed out the security proofs of SPEKE+ and J-PAKE+, 
include the relevant background material on Zero Knowledge Proofs needed to explicitly specify all aspects 
of these protocols, and fixed some minor Java implementation errors which could cause the timings in 
Hao et. al.~\cite{HaYiChSh15} to be slightly inaccurate.

%%%%%%%%%%%%%%%%%%%%%
% Two Party Schemes
%%%%%%%%%%%%%%%%%%%%%

\section{Two Party Password-Authenticated Key Exchange (PAKE)} 
\label{sec:PAKE}
 [The background information in this section, and details about SPEKE and J-PAKE, are based on the presentation 
 in Hao and Ryan~\cite{HaRy2010}. The information on the Dragonfly protocol was taken from Harkins~\cite{Ha15}.  
 The sub-section about PAK/PPK is based on work of \cite{BoMaPa00}]
 \\
 
 The genesis of password-authenticated key exchange is widely credited to the 1992 work of Bellovin and 
 Merrit~\cite{BeMe92}, whose protocol (known as Encrypted Key Exchange -- or EKE, for short) came to 
 be known as the first PAKE.  All PAKEs aim for two main goals: to require their users to provide a zero 
 knowledge proof of a short password known to both parties \emph{a priori} (that is, before the protocol 
 has begun) and to leverage knowledge of this password to facilitate an authenticated key exchange.  As 
 password are assumed to be low entropy -- for instance, they are often assumed to be human memorizable 
 passwords (typically assumed to be approximately 20-30 bits of entropy) -- if the passwords 
 themselves were broadcast they would need to be protected, for instance using SSL.  This would require Public 
 Key Infrastructure, which can be expensive, hence the use of zero knowledge proofs.
 \\

 Indeed, it is somewhat miraculous that PAKEs -- which transform a low entropy shared secret into a 
 much larger and more complicated shared key -- exist at all.  Although the EKE protocol of Bellovin and 
 Merrit was later shown to have weaknesses (see Jaspan~\cite{Ja96}, for example) its great contribution was 
 to show that such schemes can be achieved.  Due to its historical significance, we outline the Diffie-Hellman
 variant of the method here (an RSA variant, also by Bellovin and Merrit, was later shown to be insecure).  
 Given a symmetric encryption function $[\cdot]_s$ which uses a password $s$ shared
 by agents Alice and Bob as a key, the algorithm does the following: \comment{Do we want a better way of writing protocols?}\comment{Yi: Probably...}
 \\

 \begin{itemize}
 \item[\textbf{Setup:}] Let $\alpha$ be a primitive root of $\mathbb{Z}_p$
 \item[\textbf{Alice:}] Pick $x_a \in \mathbb{Z}_p \setminus \{0\}$ randomly
 \item[] Send Bob $\left[\alpha^{x_a}\right]_s$
  \item[\textbf{Bob:}] Pick $x_b \in \mathbb{Z}_p \setminus \{0\}$ randomly
 \item[] Send Alice $\left[\alpha^{x_b}\right]_s$
 \item[]
 \end{itemize}

At the end, both Alice and Bob share the key $K = \alpha^{x_a \cdot x_b}$.  The weakness of the algorithm 
comes from an issue discussed above: as the password has low entropy in order for the scheme to be 
secure the input into $[\cdot]_s$ must essentially look like a random number.  But a 1024 bit number 
modulo $p$ is not random, and a passive attacker can try candidate passwords to decipher 
$\left[\alpha^{x_a}\right]_s$ and immediately rule out any passwords giving a result in the range $[p,2^{1024}-1]$.
\\

Although EKE has this (and other) weaknesses, it was extremely influential and its general characteristics are 
reflected in many of the more advanced protocols we outline below.  Before giving these methods, we must outline 
what constitutes a good measure of security for a PAKE.  In the modern literature, a full proof of security for a 
two party PAKE typically consists of proving each of the following four properties:
\\

\begin{itemize}
 \item[] \textbf{(Offline dictionary attack resistance)}
 \item[] The PAKE does not leak any information to a passive or active attacker which can be 
 used by the attacker to determine the password through a brute force search (the protocol 
 cannot reveal a hash of the password, for instance).
 \item[]
 \item[] \textbf{(Forward secrecy for established keys)}
 \item[] If the password is disclosed, past session keys cannot be computed by an attacker.  
 This implies that a \emph{passive} attacker who knows the password he cannot learn a session 
 key by observing communication between Alice and Bob (of course, an active attacker could 
 establish a shared key with one of the participants as he would have access to all of their 
 secret information).
 \item[]
 \item[] \textbf{(Known session security)}
 \item[] If an attacker learns all secrets of a protocol in progress, it does not reveal 
 any information about other established sessions.
  \item[]
 \item[] \textbf{(Online dictionary attack resistance)}
 \item[] An active attacker can only test one password per protocol execution (this is the 
 best that we can reasonably assume, as any attacker can randomly guess a password and 
 run the protocol -- at some point the key must be confirmed, either explicitly through the 
 PAKE or when the key is used in some other protocol, and the attacker will know whether or
 not his guess was correct).
\item[]
\end{itemize}

 These properties are illustrated in sub-Section~\ref{sec:JPAKE} when we outline proofs of these properties
 for the J-PAKE protocol. Some PAKEs satisfy the additional requirement that an attacker not be 
 allowed to impersonate other users to some fixed target after obtaining (through illicit means) password 
 verification files for those users which were stored by the target.  The schemes with this additional property 
 are known as augmented PAKEs, although some (for instance, Hao et. al.~\cite{HaYiChSh15}) have argued that 
 such a requirement is not useful as the low entropy of the password means that it will soon be discovered 
 through an offline dictionary attack on the verification files.  Nevertheless, augmented variants exist for a number
of balanced PAKEs (for example Augmented-EKE for EKE, B-SPEKE for SPEKE and PAK-Z for PAK/PPK). 

\subsection{SPEKE}
\input{sec-SPEKE}

\subsection{J-PAKE} 
\label{sec:JPAKE}
\input{sec-JPAKE}

\subsection{Dragonfly}
\label{sec:Dragon}
\input{sec-DRAGON}

\subsection{PAK/PPK}
\label{sec:PPK}
\input{sec-PPK}

\subsection{Zero-Knowledge Proof Protocols}
\label{sec:ZKP}
\input{sec-ZKP}

%%%%%%%%%%%%%%%%%%%%%
% Group Schemes
%%%%%%%%%%%%%%%%%%%%%

\section{Group Password-Authenticated Key Exchange (GPAKE)} 
\label{sec:GPAKE}
\input{sec-GP-BACKGROUND}

\subsection{SPEKE+ and J-PAKE+}
\input{sec-SPEKE+JPAKE+}

\subsection{Dragonfly+}
\input{sec-DRAGON+}

\subsection{PPK+}
\input{sec-PPK+}

%%%%%%%%%%%%%%%%%%%%%%%%
% Implementation Results
%%%%%%%%%%%%%%%%%%%%%%%%

\section{Implementation Results}
\label{sec:Implementation}
\input{sec-IMPLEMENT}

%%%%%%%%%%%%%%%%%%%%%
% Conclusion
%%%%%%%%%%%%%%%%%%%%%

\section{Conclusion}
\label{sec:Conclusion}
The conclusion



%%%%%%%%%%%%%%%%%%%%%
% Bibliography
%%%%%%%%%%%%%%%%%%%%%

\nocite{*}
\bibliographystyle{plain}
\bibliography{Project}

\end{document}






