Dragonfly -- another PAKE created by Harkins~\cite{Ha15} -- is also based on discrete logarithm cryptography.  This general setup means one can work  either in a finite field or use elliptic curves, and like all our implementations for this project we describe and use the finite field version. Similar to J-PAKE (and unlike SPEKE), there are no assumptions on the order of the underlying group (i.e., its order does not have to be of theform $p = 2q-1$, for $q$ prime).\\Let $p$ be a large prime. We will let $Q$ denote a cyclic subgroup of $\mathbb{Z}_p^*$ with prime order $q$ -- hence $q | (p-1)$. In addition to $p$ and $q$, a hash function $H$ is also agreed upon, and it assumed that Alice and Bob share the password $\pi \in Q$. The protocol specification maps the passwordarbitrarily (but deterministically) to the element $\pi$, and includes some example algorithms to perform the actual mapping. These examples are omitted here. Due to a (slightly) increased complexity over the protocols discussed so far, we begin with a text description:\begin{itemize}    \item[\textbf{(Round 1)}] Alice chooses two random values $r_A, m_A \in_R \mathbb{Z}_q^*$ and computes $s_A = r_A + m_A \mod q$ along with the element        $E_A = \pi^{-m_A} \mod p$. If $s_A < 2$ (to avoid a small subgroup attack), she repeats this step. She sends $s_A$ and $E_A$ to Bob.        \label{enum:dragonfly2}    \item[]    \item[] Bob chooses two random values $r_B, m_B \in_R \mathbb{Z}_q^*$. He computes $s_B = r_B + m_B \mod q$ and the element        $E_B = \pi^{-m_B} \mod p$. If $s_B < 2$, he repeats this step over. He sends $s_A$ and $E_A$ to Alice.        \label{enum:dragonfly3}    \item[]    \item[] Each member verifies that one of $E_A \neq E_B$ or $s_A \neq s_B$ is true to avoid a reflection attack.        \footnote{Otherwise an attacker could be accepted as the variables $A$ and $B$ would be equal in Round 2. Note, however, that the attacker would still be unable to compute the key without knowledge of the password.}    \item[]    \item[\textbf{(Round 2)}] Alice computes the shared secret $ss = (\pi^{s_B} E_B)^{r_A} = \pi^{r_A r_B} \mod p$.     \item[] Alice sends $A = H(ss || E_A || s_A || E_B || s_B)$ to Bob.    \item[]    \item[] Bob computes the shared secret $ss = (\pi^{s_A} E_A)^{r_B} = \pi^{r_A r_B} \mod p$.     \item[] Bob sends $B = H(ss || E_B || s_B || E_A || s_A)$ to Alice.    \item[]    \item[] Alice and Bob both confirm the received hash values are correct and compute the shared key     \[ K = H(ss || E_A \times E_B || (s_A + s_B) \mod q).\]\end{itemize}This protocol is illustrated in Figure \ref{fig:dragonfly}.  We note that despite its status as an IEEE 802.11-2012 standard no securityproof of Dragonfly has yet been derived (the document of Harkins~\cite{Ha15} states that it possesses security features such as offline%dictionary attack resistance).  In fact, Steps \ref{enum:dragonfly2} and \ref{enum:dragonfly3} were modified in the most recent updatedictionary attack resistance).  In fact, Round 1 of the protocol was modified in the most recent update      % references aren't workingto the Dragonfly protocol after a small subgroup attack was discovered by Clarke and Hao~\cite{Ha2014}; the protocol now works around thisby checking $s_A$ and $s_B$, and repeating the step until the values generated are safe. The chief benefit of Dragonfly is its speed:as the results of Section \ref{sec:Implementation} show, Dragonfly+ is the fastest group protocol we tested.\begin{figure}[h]    \begin{tikzpicture}        \matrix (m)[matrix of nodes, column sep=1cm, column 2/.style={minimum width=1.5cm}, nodes in empty cells]{            Alice                                           &                   & Bob                                           \\            repeat: randomly choose $r_A, m_A \in \mathbb{Z}_q^*$   &   & repeat: randomly choose $r_B, m_B \in \mathbb{Z}_q^*$ \\            $s_A = r_A + m_A \mod q$ until $s_A \geq 2$     &                   & $s_B = r_B + m_B \mod q$ until $s_B \geq 2$   \\            $E_A = \pi^{-m_A} \mod p$                       & $s_A, E_A$        & $E_B = \pi^{-m_B} \mod p$                     \\                                                            & $s_B, E_B$        &                                               \\                                                            &                   &                                               \\            Verify $E_A \neq E_B$ or $s_A \neq s_B$         &                   & Verify $E_A \neq E_B$ or $s_A \neq s_B$       \\            $ss = (\pi^{s_B} E_B)^{r_A} = \pi^{r_A r_B} \mod p$  &       & $ss = (\pi^{s_A} E_A)^{r_B} = \pi^{r_A r_B} \mod p$  \\            $A = H(ss || E_A || s_A || E_B || s_B)$         & $A$               & $B = H(ss || E_B || s_B || E_A || s_A)$       \\                                                            & $B$               &                                               \\            Verify $B$                                      &                   & Verify $A$                                    \\            $K = H(ss || E_A \times E_B || (s_A + s_B) \mod q)$  &       & $K = H(ss || E_A \times E_B || (s_A + s_B) \mod q)$  \\        };        % draw the nodes - these are 1-based indicies on the matrix called `m`, ie to draw in (x,y), reference it as `m-x-y`        \draw[shorten <=-1.5cm,shorten >=-1.5cm] (m-1-1.south east)--(m-1-1.south west);        % underline "Alice"        \draw[shorten <=-1.5cm,shorten >=-1.5cm] (m-1-3.south east)--(m-1-3.south west);        % underline "Bob"        \draw[shorten <=-1cm,shorten >=-1cm,-latex] (m-4-2.south west)--(m-4-2.south east);     % arrow below sending s_A, E_A        \draw[shorten <=-1cm,shorten >=-1cm,-latex] (m-5-2.south east)--(m-5-2.south west);     % arrow below sending s_B, E_B        \draw[shorten <=-1cm,shorten >=-1cm,-latex] (m-9-2.south west)--(m-9-2.south east);     % arrow below sending A        \draw[shorten <=-1cm,shorten >=-1cm,-latex] (m-10-2.south east)--(m-10-2.south west);   % arrow below sending B    \end{tikzpicture}    \caption{The Dragonfly protocol.}    \label{fig:dragonfly}\end{figure}